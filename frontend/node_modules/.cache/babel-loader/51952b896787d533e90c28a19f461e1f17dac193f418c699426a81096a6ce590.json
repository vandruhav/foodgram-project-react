{"ast":null,"code":"import _defineProperty from\"C:/Dev/foodgram-project-react/frontend/node_modules/@babel/runtime/helpers/esm/defineProperty.js\";import _objectSpread from\"C:/Dev/foodgram-project-react/frontend/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import _slicedToArray from\"C:/Dev/foodgram-project-react/frontend/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import{Card,Title,Pagination,CardList,Button,CheckboxGroup,Container,Main}from'../../components';import cn from'classnames';import styles from'./styles.module.css';import{useRecipes}from'../../utils/index.js';import{useEffect,useState,useContext}from'react';import api from'../../api';import{useParams,useHistory}from'react-router-dom';import{UserContext}from'../../contexts';import MetaTags from'react-meta-tags';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{createElement as _createElement}from\"react\";var UserPage=function UserPage(_ref){var updateOrders=_ref.updateOrders;var _useRecipes=useRecipes(),recipes=_useRecipes.recipes,setRecipes=_useRecipes.setRecipes,recipesCount=_useRecipes.recipesCount,setRecipesCount=_useRecipes.setRecipesCount,recipesPage=_useRecipes.recipesPage,setRecipesPage=_useRecipes.setRecipesPage,tagsValue=_useRecipes.tagsValue,setTagsValue=_useRecipes.setTagsValue,handleTagsChange=_useRecipes.handleTagsChange,handleLike=_useRecipes.handleLike,handleAddToCart=_useRecipes.handleAddToCart;var _useParams=useParams(),id=_useParams.id;var _useState=useState(null),_useState2=_slicedToArray(_useState,2),user=_useState2[0],setUser=_useState2[1];var _useState3=useState(false),_useState4=_slicedToArray(_useState3,2),subscribed=_useState4[0],setSubscribed=_useState4[1];var history=useHistory();var userContext=useContext(UserContext);var getRecipes=function getRecipes(_ref2){var _ref2$page=_ref2.page,page=_ref2$page===void 0?1:_ref2$page,tags=_ref2.tags;api.getRecipes({page:page,author:id,tags:tags}).then(function(res){var results=res.results,count=res.count;setRecipes(results);setRecipesCount(count);});};var getUser=function getUser(){api.getUser({id:id}).then(function(res){setUser(res);setSubscribed(res.is_subscribed);}).catch(function(err){history.push('/recipes');});};useEffect(function(_){if(!user){return;}getRecipes({page:recipesPage,tags:tagsValue,author:user.id});},[recipesPage,tagsValue,user]);useEffect(function(_){getUser();},[]);useEffect(function(_){api.getTags().then(function(tags){setTagsValue(tags.map(function(tag){return _objectSpread(_objectSpread({},tag),{},{value:true});}));});},[]);return/*#__PURE__*/_jsx(Main,{children:/*#__PURE__*/_jsxs(Container,{className:styles.container,children:[/*#__PURE__*/_jsxs(MetaTags,{children:[/*#__PURE__*/_jsx(\"title\",{children:user?\"\".concat(user.first_name,\" \").concat(user.last_name):'Страница пользователя'}),/*#__PURE__*/_jsx(\"meta\",{name:\"description\",content:user?\"\\u041F\\u0440\\u043E\\u0434\\u0443\\u043A\\u0442\\u043E\\u0432\\u044B\\u0439 \\u043F\\u043E\\u043C\\u043E\\u0449\\u043D\\u0438\\u043A - \".concat(user.first_name,\" \").concat(user.last_name):'Продуктовый помощник - Страница пользователя'}),/*#__PURE__*/_jsx(\"meta\",{property:\"og:title\",content:user?\"\".concat(user.first_name,\" \").concat(user.last_name):'Страница пользователя'})]}),/*#__PURE__*/_jsxs(\"div\",{className:styles.title,children:[/*#__PURE__*/_jsx(Title,{className:cn(_defineProperty({},styles.titleText,(userContext||{}).id!==(user||{}).id)),title:user?\"\".concat(user.first_name,\" \").concat(user.last_name):''}),/*#__PURE__*/_jsx(CheckboxGroup,{values:tagsValue,handleChange:function handleChange(value){setRecipesPage(1);handleTagsChange(value);}})]}),(userContext||{}).id!==(user||{}).id&&/*#__PURE__*/_jsx(Button,{className:styles.buttonSubscribe,clickHandler:function clickHandler(_){var method=subscribed?api.deleteSubscriptions.bind(api):api.subscribe.bind(api);method({author_id:id}).then(function(_){setSubscribed(!subscribed);});},children:subscribed?'Отписаться от автора':'Подписаться на автора'}),/*#__PURE__*/_jsx(CardList,{children:recipes.map(function(card){return/*#__PURE__*/_createElement(Card,_objectSpread(_objectSpread({},card),{},{key:card.id,updateOrders:updateOrders,handleLike:handleLike,handleAddToCart:handleAddToCart}));})}),/*#__PURE__*/_jsx(Pagination,{count:recipesCount,limit:6,page:recipesPage,onPageChange:function onPageChange(page){return setRecipesPage(page);}})]})});};export default UserPage;","map":{"version":3,"names":["Card","Title","Pagination","CardList","Button","CheckboxGroup","Container","Main","cn","styles","useRecipes","useEffect","useState","useContext","api","useParams","useHistory","UserContext","MetaTags","UserPage","updateOrders","recipes","setRecipes","recipesCount","setRecipesCount","recipesPage","setRecipesPage","tagsValue","setTagsValue","handleTagsChange","handleLike","handleAddToCart","id","user","setUser","subscribed","setSubscribed","history","userContext","getRecipes","page","tags","author","then","res","results","count","getUser","is_subscribed","catch","err","push","_","getTags","map","tag","value","container","first_name","last_name","title","titleText","buttonSubscribe","method","deleteSubscriptions","bind","subscribe","author_id","card"],"sources":["C:/Dev/foodgram-project-react/frontend/src/pages/user/index.js"],"sourcesContent":["import {\n  Card,\n  Title,\n  Pagination,\n  CardList,\n  Button,\n  CheckboxGroup,\n  Container,\n  Main \n} from '../../components'\nimport cn from 'classnames'\nimport styles from './styles.module.css'\nimport { useRecipes } from '../../utils/index.js'\nimport { useEffect, useState, useContext } from 'react'\nimport api from '../../api'\nimport { useParams, useHistory } from 'react-router-dom'\nimport { UserContext } from '../../contexts'\nimport MetaTags from 'react-meta-tags'\n\nconst UserPage = ({ updateOrders }) => {\n  const {\n    recipes,\n    setRecipes,\n    recipesCount,\n    setRecipesCount,\n    recipesPage,\n    setRecipesPage,\n    tagsValue,\n    setTagsValue,\n    handleTagsChange,\n    handleLike,\n    handleAddToCart\n  } = useRecipes()\n  const { id } = useParams()\n  const [ user, setUser ] = useState(null)\n  const [ subscribed, setSubscribed ] = useState(false)\n  const history = useHistory()\n  const userContext = useContext(UserContext)\n\n  const getRecipes = ({ page = 1, tags }) => {\n    api\n      .getRecipes({ page, author: id, tags })\n        .then(res => {\n          const { results, count } = res\n          setRecipes(results)\n          setRecipesCount(count)\n        })\n  }\n\n  const getUser = () => {\n    api.getUser({ id })\n      .then(res => {\n        setUser(res)\n        setSubscribed(res.is_subscribed)\n      })\n      .catch(err => {\n        history.push('/recipes')\n      })\n  }\n\n  useEffect(_ => {\n    if (!user) { return }\n    getRecipes({ page: recipesPage, tags: tagsValue, author: user.id })\n  }, [ recipesPage, tagsValue, user ])\n\n  useEffect(_ => {\n    getUser()\n  }, [])\n\n  useEffect(_ => {\n    api.getTags()\n      .then(tags => {\n        setTagsValue(tags.map(tag => ({ ...tag, value: true })))\n      })\n  }, [])\n\n\n  return <Main>\n    <Container className={styles.container}>\n      <MetaTags>\n        <title>{user ? `${user.first_name} ${user.last_name}` : 'Страница пользователя'}</title>\n        <meta name=\"description\" content={user ? `Продуктовый помощник - ${user.first_name} ${user.last_name}` : 'Продуктовый помощник - Страница пользователя'} />\n        <meta property=\"og:title\" content={user ? `${user.first_name} ${user.last_name}` : 'Страница пользователя'} />\n      </MetaTags>\n      <div className={styles.title}>\n        <Title\n          className={cn({\n            [styles.titleText]: (userContext || {}).id !== (user || {}).id\n          })}\n          title={user ? `${user.first_name} ${user.last_name}` : ''}\n        />\n        <CheckboxGroup\n          values={tagsValue}\n          handleChange={value => {\n            setRecipesPage(1)\n            handleTagsChange(value)\n          }}\n        />\n      </div>\n      {(userContext || {}).id !== (user || {}).id && <Button\n        className={styles.buttonSubscribe}\n        clickHandler={_ => {\n          const method = subscribed ? api.deleteSubscriptions.bind(api) : api.subscribe.bind(api) \n            method({\n              author_id: id\n            })\n            .then(_ => {\n              setSubscribed(!subscribed)\n            })\n        }}\n      >\n        {subscribed ? 'Отписаться от автора' : 'Подписаться на автора'}\n      </Button>}\n      <CardList>\n        {recipes.map(card => <Card\n          {...card}\n          key={card.id}\n          updateOrders={updateOrders}\n          handleLike={handleLike}\n          handleAddToCart={handleAddToCart}\n        />)}\n      </CardList>\n      <Pagination\n        count={recipesCount}\n        limit={6}\n        page={recipesPage}\n        onPageChange={page => setRecipesPage(page)}\n      />\n    </Container>\n  </Main>\n}\n\nexport default UserPage\n\n"],"mappings":"qXAAA,OACEA,IAAI,CACJC,KAAK,CACLC,UAAU,CACVC,QAAQ,CACRC,MAAM,CACNC,aAAa,CACbC,SAAS,CACTC,IAAI,KACC,kBAAkB,CACzB,MAAOC,GAAE,KAAM,YAAY,CAC3B,MAAOC,OAAM,KAAM,qBAAqB,CACxC,OAASC,UAAU,KAAQ,sBAAsB,CACjD,OAASC,SAAS,CAAEC,QAAQ,CAAEC,UAAU,KAAQ,OAAO,CACvD,MAAOC,IAAG,KAAM,WAAW,CAC3B,OAASC,SAAS,CAAEC,UAAU,KAAQ,kBAAkB,CACxD,OAASC,WAAW,KAAQ,gBAAgB,CAC5C,MAAOC,SAAQ,KAAM,iBAAiB,4IAEtC,GAAMC,SAAQ,CAAG,QAAXA,SAAQ,MAAyB,IAAnBC,aAAY,MAAZA,YAAY,CAC9B,gBAYIV,UAAU,EAAE,CAXdW,OAAO,aAAPA,OAAO,CACPC,UAAU,aAAVA,UAAU,CACVC,YAAY,aAAZA,YAAY,CACZC,eAAe,aAAfA,eAAe,CACfC,WAAW,aAAXA,WAAW,CACXC,cAAc,aAAdA,cAAc,CACdC,SAAS,aAATA,SAAS,CACTC,YAAY,aAAZA,YAAY,CACZC,gBAAgB,aAAhBA,gBAAgB,CAChBC,UAAU,aAAVA,UAAU,CACVC,eAAe,aAAfA,eAAe,CAEjB,eAAehB,SAAS,EAAE,CAAlBiB,EAAE,YAAFA,EAAE,CACV,cAA0BpB,QAAQ,CAAC,IAAI,CAAC,wCAAhCqB,IAAI,eAAEC,OAAO,eACrB,eAAsCtB,QAAQ,CAAC,KAAK,CAAC,yCAA7CuB,UAAU,eAAEC,aAAa,eACjC,GAAMC,QAAO,CAAGrB,UAAU,EAAE,CAC5B,GAAMsB,YAAW,CAAGzB,UAAU,CAACI,WAAW,CAAC,CAE3C,GAAMsB,WAAU,CAAG,QAAbA,WAAU,OAA2B,sBAArBC,IAAI,CAAJA,IAAI,qBAAG,CAAC,YAAEC,IAAI,OAAJA,IAAI,CAClC3B,GAAG,CACAyB,UAAU,CAAC,CAAEC,IAAI,CAAJA,IAAI,CAAEE,MAAM,CAAEV,EAAE,CAAES,IAAI,CAAJA,IAAK,CAAC,CAAC,CACpCE,IAAI,CAAC,SAAAC,GAAG,CAAI,CACX,GAAQC,QAAO,CAAYD,GAAG,CAAtBC,OAAO,CAAEC,KAAK,CAAKF,GAAG,CAAbE,KAAK,CACtBxB,UAAU,CAACuB,OAAO,CAAC,CACnBrB,eAAe,CAACsB,KAAK,CAAC,CACxB,CAAC,CAAC,CACR,CAAC,CAED,GAAMC,QAAO,CAAG,QAAVA,QAAO,EAAS,CACpBjC,GAAG,CAACiC,OAAO,CAAC,CAAEf,EAAE,CAAFA,EAAG,CAAC,CAAC,CAChBW,IAAI,CAAC,SAAAC,GAAG,CAAI,CACXV,OAAO,CAACU,GAAG,CAAC,CACZR,aAAa,CAACQ,GAAG,CAACI,aAAa,CAAC,CAClC,CAAC,CAAC,CACDC,KAAK,CAAC,SAAAC,GAAG,CAAI,CACZb,OAAO,CAACc,IAAI,CAAC,UAAU,CAAC,CAC1B,CAAC,CAAC,CACN,CAAC,CAEDxC,SAAS,CAAC,SAAAyC,CAAC,CAAI,CACb,GAAI,CAACnB,IAAI,CAAE,CAAE,OAAO,CACpBM,UAAU,CAAC,CAAEC,IAAI,CAAEf,WAAW,CAAEgB,IAAI,CAAEd,SAAS,CAAEe,MAAM,CAAET,IAAI,CAACD,EAAG,CAAC,CAAC,CACrE,CAAC,CAAE,CAAEP,WAAW,CAAEE,SAAS,CAAEM,IAAI,CAAE,CAAC,CAEpCtB,SAAS,CAAC,SAAAyC,CAAC,CAAI,CACbL,OAAO,EAAE,CACX,CAAC,CAAE,EAAE,CAAC,CAENpC,SAAS,CAAC,SAAAyC,CAAC,CAAI,CACbtC,GAAG,CAACuC,OAAO,EAAE,CACVV,IAAI,CAAC,SAAAF,IAAI,CAAI,CACZb,YAAY,CAACa,IAAI,CAACa,GAAG,CAAC,SAAAC,GAAG,wCAAUA,GAAG,MAAEC,KAAK,CAAE,IAAI,IAAG,CAAC,CAAC,CAC1D,CAAC,CAAC,CACN,CAAC,CAAE,EAAE,CAAC,CAGN,mBAAO,KAAC,IAAI,wBACV,MAAC,SAAS,EAAC,SAAS,CAAE/C,MAAM,CAACgD,SAAU,wBACrC,MAAC,QAAQ,yBACP,uBAAQxB,IAAI,WAAMA,IAAI,CAACyB,UAAU,aAAIzB,IAAI,CAAC0B,SAAS,EAAK,uBAAuB,EAAS,cACxF,aAAM,IAAI,CAAC,aAAa,CAAC,OAAO,CAAE1B,IAAI,iIAA6BA,IAAI,CAACyB,UAAU,aAAIzB,IAAI,CAAC0B,SAAS,EAAK,8CAA+C,EAAG,cAC3J,aAAM,QAAQ,CAAC,UAAU,CAAC,OAAO,CAAE1B,IAAI,WAAMA,IAAI,CAACyB,UAAU,aAAIzB,IAAI,CAAC0B,SAAS,EAAK,uBAAwB,EAAG,GACrG,cACX,aAAK,SAAS,CAAElD,MAAM,CAACmD,KAAM,wBAC3B,KAAC,KAAK,EACJ,SAAS,CAAEpD,EAAE,oBACVC,MAAM,CAACoD,SAAS,CAAG,CAACvB,WAAW,EAAI,CAAC,CAAC,EAAEN,EAAE,GAAK,CAACC,IAAI,EAAI,CAAC,CAAC,EAAED,EAAE,EAC7D,CACH,KAAK,CAAEC,IAAI,WAAMA,IAAI,CAACyB,UAAU,aAAIzB,IAAI,CAAC0B,SAAS,EAAK,EAAG,EAC1D,cACF,KAAC,aAAa,EACZ,MAAM,CAAEhC,SAAU,CAClB,YAAY,CAAE,sBAAA6B,KAAK,CAAI,CACrB9B,cAAc,CAAC,CAAC,CAAC,CACjBG,gBAAgB,CAAC2B,KAAK,CAAC,CACzB,CAAE,EACF,GACE,CACL,CAAClB,WAAW,EAAI,CAAC,CAAC,EAAEN,EAAE,GAAK,CAACC,IAAI,EAAI,CAAC,CAAC,EAAED,EAAE,eAAI,KAAC,MAAM,EACpD,SAAS,CAAEvB,MAAM,CAACqD,eAAgB,CAClC,YAAY,CAAE,sBAAAV,CAAC,CAAI,CACjB,GAAMW,OAAM,CAAG5B,UAAU,CAAGrB,GAAG,CAACkD,mBAAmB,CAACC,IAAI,CAACnD,GAAG,CAAC,CAAGA,GAAG,CAACoD,SAAS,CAACD,IAAI,CAACnD,GAAG,CAAC,CACrFiD,MAAM,CAAC,CACLI,SAAS,CAAEnC,EACb,CAAC,CAAC,CACDW,IAAI,CAAC,SAAAS,CAAC,CAAI,CACThB,aAAa,CAAC,CAACD,UAAU,CAAC,CAC5B,CAAC,CAAC,CACN,CAAE,UAEDA,UAAU,CAAG,sBAAsB,CAAG,uBAAuB,EACvD,cACT,KAAC,QAAQ,WACNd,OAAO,CAACiC,GAAG,CAAC,SAAAc,IAAI,qBAAI,eAAC,IAAI,gCACpBA,IAAI,MACR,GAAG,CAAEA,IAAI,CAACpC,EAAG,CACb,YAAY,CAAEZ,YAAa,CAC3B,UAAU,CAAEU,UAAW,CACvB,eAAe,CAAEC,eAAgB,GACjC,GAAC,EACM,cACX,KAAC,UAAU,EACT,KAAK,CAAER,YAAa,CACpB,KAAK,CAAE,CAAE,CACT,IAAI,CAAEE,WAAY,CAClB,YAAY,CAAE,sBAAAe,IAAI,QAAId,eAAc,CAACc,IAAI,CAAC,EAAC,EAC3C,GACQ,EACP,CACT,CAAC,CAED,cAAerB,SAAQ"},"metadata":{},"sourceType":"module","externalDependencies":[]}
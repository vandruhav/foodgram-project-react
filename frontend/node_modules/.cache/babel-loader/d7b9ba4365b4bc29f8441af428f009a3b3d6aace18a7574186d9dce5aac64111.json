{"ast":null,"code":"import _slicedToArray from\"C:/Dev/foodgram-project-react/frontend/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import{Container,Main,Button,TagsContainer,Icons,LinkComponent}from'../../components';import{UserContext,AuthContext}from'../../contexts';import{useContext,useState,useEffect}from'react';import styles from'./styles.module.css';import Ingredients from'./ingredients';import Description from'./description';import cn from'classnames';import{useRouteMatch,useParams,useHistory}from'react-router-dom';import MetaTags from'react-meta-tags';import{useRecipe}from'../../utils/index.js';import api from'../../api';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";var SingleCard=function SingleCard(_ref){var loadItem=_ref.loadItem,updateOrders=_ref.updateOrders;var _useState=useState(true),_useState2=_slicedToArray(_useState,2),loading=_useState2[0],setLoading=_useState2[1];var _useRecipe=useRecipe(),recipe=_useRecipe.recipe,setRecipe=_useRecipe.setRecipe,handleLike=_useRecipe.handleLike,handleAddToCart=_useRecipe.handleAddToCart,handleSubscribe=_useRecipe.handleSubscribe;var authContext=useContext(AuthContext);var userContext=useContext(UserContext);var _useParams=useParams(),id=_useParams.id;var history=useHistory();useEffect(function(_){api.getRecipe({recipe_id:id}).then(function(res){setRecipe(res);setLoading(false);}).catch(function(err){history.push('/recipes');});},[]);var _useRouteMatch=useRouteMatch(),url=_useRouteMatch.url;var _recipe$author=recipe.author,author=_recipe$author===void 0?{}:_recipe$author,image=recipe.image,tags=recipe.tags,cooking_time=recipe.cooking_time,name=recipe.name,ingredients=recipe.ingredients,text=recipe.text,is_favorited=recipe.is_favorited,is_in_shopping_cart=recipe.is_in_shopping_cart;return/*#__PURE__*/_jsx(Main,{children:/*#__PURE__*/_jsxs(Container,{children:[/*#__PURE__*/_jsxs(MetaTags,{children:[/*#__PURE__*/_jsx(\"title\",{children:name}),/*#__PURE__*/_jsx(\"meta\",{name:\"description\",content:\"\\u041F\\u0440\\u043E\\u0434\\u0443\\u043A\\u0442\\u043E\\u0432\\u044B\\u0439 \\u043F\\u043E\\u043C\\u043E\\u0449\\u043D\\u0438\\u043A - \".concat(name)}),/*#__PURE__*/_jsx(\"meta\",{property:\"og:title\",content:name})]}),/*#__PURE__*/_jsxs(\"div\",{className:styles['single-card'],children:[/*#__PURE__*/_jsx(\"img\",{src:image,alt:name,className:styles[\"single-card__image\"]}),/*#__PURE__*/_jsxs(\"div\",{className:styles[\"single-card__info\"],children:[/*#__PURE__*/_jsxs(\"div\",{className:styles[\"single-card__header-info\"],children:[/*#__PURE__*/_jsx(\"h1\",{className:styles[\"single-card__title\"],children:name}),authContext&&/*#__PURE__*/_jsx(Button,{modifier:\"style_none\",clickHandler:function clickHandler(_){handleLike({id:id,toLike:Number(!is_favorited)});},children:is_favorited?/*#__PURE__*/_jsx(Icons.StarBigActiveIcon,{}):/*#__PURE__*/_jsx(Icons.StarBigIcon,{})})]}),/*#__PURE__*/_jsx(TagsContainer,{tags:tags}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsxs(\"p\",{className:styles['single-card__text'],children:[/*#__PURE__*/_jsx(Icons.ClockIcon,{}),\" \",cooking_time,\" \\u043C\\u0438\\u043D.\"]}),/*#__PURE__*/_jsxs(\"p\",{className:styles['single-card__text_with_link'],children:[/*#__PURE__*/_jsxs(\"div\",{className:styles['single-card__text'],children:[/*#__PURE__*/_jsx(Icons.UserIcon,{}),\" \",/*#__PURE__*/_jsx(LinkComponent,{title:\"\".concat(author.first_name,\" \").concat(author.last_name),href:\"/user/\".concat(author.id),className:styles['single-card__link']})]}),(userContext||{}).id===author.id&&/*#__PURE__*/_jsx(LinkComponent,{href:\"\".concat(url,\"/edit\"),title:\"\\u0420\\u0435\\u0434\\u0430\\u043A\\u0442\\u0438\\u0440\\u043E\\u0432\\u0430\\u0442\\u044C \\u0440\\u0435\\u0446\\u0435\\u043F\\u0442\",className:styles['single-card__edit']})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:styles['single-card__buttons'],children:[authContext&&/*#__PURE__*/_jsx(Button,{className:styles['single-card__button'],modifier:is_in_shopping_cart?'style_light':'style_dark-blue',clickHandler:function clickHandler(_){handleAddToCart({id:id,toAdd:Number(!is_in_shopping_cart),callback:updateOrders});},children:is_in_shopping_cart?/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(Icons.DoneIcon,{color:\"#4A61DD\"}),\"\\u0420\\u0435\\u0446\\u0435\\u043F\\u0442 \\u0434\\u043E\\u0431\\u0430\\u0432\\u043B\\u0435\\u043D\"]}):/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(Icons.PlusIcon,{}),\" \\u0414\\u043E\\u0431\\u0430\\u0432\\u0438\\u0442\\u044C \\u0432 \\u043F\\u043E\\u043A\\u0443\\u043F\\u043A\\u0438\"]})}),(userContext||{}).id!==author.id&&authContext&&/*#__PURE__*/_jsx(Button,{className:styles['single-card__button'],modifier:\"style_light-blue\",clickHandler:function clickHandler(_){handleSubscribe({author_id:author.id,toSubscribe:!author.is_subscribed});},children:author.is_subscribed?'Отписаться от автора':'Подписаться на автора'})]}),/*#__PURE__*/_jsx(Ingredients,{ingredients:ingredients}),/*#__PURE__*/_jsx(Description,{description:text})]})]})]})});};export default SingleCard;","map":{"version":3,"names":["Container","Main","Button","TagsContainer","Icons","LinkComponent","UserContext","AuthContext","useContext","useState","useEffect","styles","Ingredients","Description","cn","useRouteMatch","useParams","useHistory","MetaTags","useRecipe","api","SingleCard","loadItem","updateOrders","loading","setLoading","recipe","setRecipe","handleLike","handleAddToCart","handleSubscribe","authContext","userContext","id","history","_","getRecipe","recipe_id","then","res","catch","err","push","url","author","image","tags","cooking_time","name","ingredients","text","is_favorited","is_in_shopping_cart","toLike","Number","first_name","last_name","toAdd","callback","author_id","toSubscribe","is_subscribed"],"sources":["C:/Dev/foodgram-project-react/frontend/src/pages/single-card/index.js"],"sourcesContent":["import { Container, Main, Button, TagsContainer, Icons, LinkComponent } from '../../components'\nimport { UserContext, AuthContext } from '../../contexts'\nimport { useContext, useState, useEffect } from 'react'\nimport styles from './styles.module.css'\nimport Ingredients from './ingredients'\nimport Description from './description'\nimport cn from 'classnames'\nimport { useRouteMatch, useParams, useHistory } from 'react-router-dom'\nimport MetaTags from 'react-meta-tags'\n\nimport { useRecipe } from '../../utils/index.js'\nimport api from '../../api'\n\nconst SingleCard = ({ loadItem, updateOrders }) => {\n  const [ loading, setLoading ] = useState(true)\n  const {\n    recipe,\n    setRecipe,\n    handleLike,\n    handleAddToCart,\n    handleSubscribe\n  } = useRecipe()\n  const authContext = useContext(AuthContext)\n  const userContext = useContext(UserContext)\n  const { id } = useParams()\n  const history = useHistory()\n\n  useEffect(_ => {\n    api.getRecipe ({\n        recipe_id: id\n      })\n      .then(res => {\n        setRecipe(res)\n        setLoading(false)\n      })\n      .catch(err => {\n        history.push('/recipes')\n      })\n  }, [])\n  \n  const { url } = useRouteMatch()\n  const {\n    author = {},\n    image,\n    tags,\n    cooking_time,\n    name,\n    ingredients,\n    text,\n    is_favorited,\n    is_in_shopping_cart\n  } = recipe\n  \n  return <Main>\n    <Container>\n      <MetaTags>\n        <title>{name}</title>\n        <meta name=\"description\" content={`Продуктовый помощник - ${name}`} />\n        <meta property=\"og:title\" content={name} />\n      </MetaTags>\n      <div className={styles['single-card']}>\n        <img src={image} alt={name} className={styles[\"single-card__image\"]} />\n        <div className={styles[\"single-card__info\"]}>\n          <div className={styles[\"single-card__header-info\"]}>\n              <h1 className={styles[\"single-card__title\"]}>{name}</h1>\n              {authContext && <Button\n                modifier='style_none'\n                clickHandler={_ => {\n                  handleLike({ id, toLike: Number(!is_favorited) })\n                }}\n              >\n                {is_favorited ? <Icons.StarBigActiveIcon /> : <Icons.StarBigIcon />}\n              </Button>}\n          </div>\n          <TagsContainer tags={tags} />\n          <div>\n            <p className={styles['single-card__text']}><Icons.ClockIcon /> {cooking_time} мин.</p>\n            <p className={styles['single-card__text_with_link']}>\n              <div className={styles['single-card__text']}>\n                <Icons.UserIcon /> <LinkComponent\n                  title={`${author.first_name} ${author.last_name}`}\n                  href={`/user/${author.id}`}\n                  className={styles['single-card__link']}\n                />\n              </div>\n              {(userContext || {}).id === author.id && <LinkComponent\n                href={`${url}/edit`}\n                title='Редактировать рецепт'\n                className={styles['single-card__edit']}\n              />}\n            </p>\n          </div>\n          <div className={styles['single-card__buttons']}>\n            {authContext && <Button\n              className={styles['single-card__button']}\n              modifier={is_in_shopping_cart ? 'style_light' : 'style_dark-blue'}\n              clickHandler={_ => {\n                handleAddToCart({ id, toAdd: Number(!is_in_shopping_cart), callback: updateOrders })\n              }}\n            >\n              \n            {is_in_shopping_cart ? <><Icons.DoneIcon color=\"#4A61DD\"/>Рецепт добавлен</> : <><Icons.PlusIcon /> Добавить в покупки</>}\n            </Button>}\n            {(userContext || {}).id !== author.id && authContext && <Button\n              className={styles['single-card__button']}\n              modifier='style_light-blue'\n              clickHandler={_ => {\n                handleSubscribe({ author_id: author.id, toSubscribe: !author.is_subscribed })\n              }}\n            >\n              {author.is_subscribed ? 'Отписаться от автора' : 'Подписаться на автора'}\n            </Button>}\n          </div>\n          <Ingredients ingredients={ingredients} />\n          <Description description={text} />\n        </div>\n    </div>\n    </Container>\n  </Main>\n}\n\nexport default SingleCard\n\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}